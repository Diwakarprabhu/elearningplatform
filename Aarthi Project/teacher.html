<!DOCTYPE html>
<html>
<head>
  <title>Teacher Dashboard</title>
  <link rel="stylesheet" href="style.css">
  <style>
     *{
      box-sizing:border-box;
    }

    body{
      margin:0;
      height:100vh;
      font-family:'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #020617, #0f172a, #1e1b4b);
      display:flex;
      justify-content:center;
      align-items:center;
    }

    .box{
      width:380px;
      background: linear-gradient(180deg, #020617, #020617);
      padding:30px 25px;
      border-radius:18px;
      box-shadow:
        0 25px 60px rgba(0,0,0,0.85),
        inset 0 0 0 1px rgba(255,255,255,0.05);
      text-align:center;
      animation:fadeIn 0.8s ease;
    }

    h2{
      color:#e5e7eb;
      margin-bottom:22px;
      font-weight:600;
      letter-spacing:0.5px;
    }

    input[type="text"],
    input[type="file"]{
      width:100%;
      padding:13px;
      margin-bottom:14px;
      border-radius:10px;
      border:1px solid #1f2937;
      background:#020617;
      color:#e5e7eb;
      font-size:14px;
      transition:0.3s;
    }

    input::placeholder{
      color:#6b7280;
    }

    input:focus{
      outline:none;
      border-color:#6366f1;
      box-shadow:0 0 0 3px rgba(99,102,241,0.25);
    }

    input[type="file"]{
      cursor:pointer;
    }
    /* FILE INPUT CLEAN + RADIUS BLEND */
input[type="file"]{
  position: relative;
  padding: 12px;
  border-radius: 12px;
  border: 1px solid #1f2937;
  background: #020617;
  color: #9ca3af;
  cursor: pointer;
}

/* Hide ugly default button */
input[type="file"]::-webkit-file-upload-button{
  visibility: hidden;
}

/* Custom button */
input[type="file"]::before{
  content: "Choose PDF";
  display: inline-block;
  background: linear-gradient(135deg, #1e1b4b, #312e81);
  color: #e5e7eb;
  padding: 8px 14px;
  border-radius: 10px;
  margin-right: 10px;
  font-size: 13px;
  cursor: pointer;
  border: 1px solid rgba(255,255,255,0.1);
}

/* Hover effect */
input[type="file"]:hover::before{
  background: linear-gradient(135deg, #4338ca, #4f46e5);
}

/* Focus glow */
input[type="file"]:focus{
  outline:none;
  box-shadow: 0 0 0 3px rgba(99,102,241,0.25);
}


    button{
      width:100%;
      padding:14px;
      margin-top:10px;
      border-radius:12px;
      border:none;
      background: linear-gradient(135deg, #6366f1, #4f46e5);
      color:white;
      font-size:16px;
      font-weight:500;
      cursor:pointer;
      transition:0.3s;
    }

    button:hover{
      transform:translateY(-2px);
      box-shadow:0 15px 30px rgba(99,102,241,0.5);
    }

    @keyframes fadeIn{
      from{
        opacity:0;
        transform:translateY(30px);
      }
      to{
        opacity:1;
        transform:translateY(0);
      }
    }
  </style>
</head>
<body>

<div class="box">
  <h2>Teacher Dashboard</h2>
  <input id="title" placeholder="PDF Title">
<input type="file" id="file" accept="application/pdf">
<button onclick="uploadPDF()">Upload PDF</button>

</div>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const SUPABASE_URL = "https://tehrflzjvyhlagxbrljc.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRlaHJmbHpqdnlobGFneGJybGpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg2OTQ2MjQsImV4cCI6MjA4NDI3MDYyNH0.wxBIEKXya0CU_-GA-6dSeWI6wS8HPwx4gmsV976MEIk";   // paste anon key

const supabaseClient = supabase.createClient(
  SUPABASE_URL,
  SUPABASE_KEY
);

/* ✅ Teacher session check */
const teacher = JSON.parse(localStorage.getItem("teacher"));
if(!teacher){
  window.location.href = "login.html";
}

/* ✅ Upload PDF */
async function uploadPDF(){
  const fileInput = document.getElementById("file");
  const titleInput = document.getElementById("title");

  if (!fileInput.files.length || !titleInput.value) {
    alert("Fill all fields");
    return;
  }

  const file = fileInput.files[0];
  const fileName = file.name.replace(/\s+/g, "_");
  const filePath = `uploads/${Date.now()}_${fileName}`;

  const { error: uploadError } = await supabaseClient
    .storage
    .from("pdfs")
    .upload(filePath, file);

  if (uploadError) {
    alert(uploadError.message);
    return;
  }

  const { data } = supabaseClient
    .storage
    .from("pdfs")
    .getPublicUrl(filePath);

  const { error } = await supabaseClient
    .from("pdfs")
    .insert([{
      title: titleInput.value,
      file_url: data.publicUrl,
      uploaded_by: teacher.id
    }]);

  if (error) {
    alert(error.message);
  } else {
    alert("PDF uploaded successfully");
    titleInput.value = "";
    fileInput.value = "";
  }
}
</script>



</body>
</html>
